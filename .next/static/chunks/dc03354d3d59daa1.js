(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12012,46349,e=>{"use strict";e.s(["default",()=>a],12012);var t=e.i(75254);let a=(0,t.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>s],46349);let s=(0,t.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},24428,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(43476);function a(){return(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-4 w-40"}),(0,t.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"w-full text-left",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:Array.from({length:6}).map((e,a)=>(0,t.jsx)("th",{className:"px-4 py-3 bg-gray-100",children:(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"})},a))})}),(0,t.jsx)("tbody",{children:Array.from({length:10}).map((e,a)=>(0,t.jsx)("tr",{className:"border-t",children:Array.from({length:10}).map((e,a)=>(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32"})},a))},a))})]})})]})}},82458,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},84774,73375,63059,e=>{"use strict";e.s(["Table",()=>r,"TableBody",()=>n,"TableCell",()=>c,"TableHead",()=>o,"TableHeader",()=>l,"TableRow",()=>i],84774);var t=e.i(43476),a=e.i(71645),s=e.i(75157);let r=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:a,className:(0,s.cn)("w-full caption-bottom text-sm",r),...l})})});r.displayName="Table";let l=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("thead",{ref:a,className:(0,s.cn)("[&_tr]:border-b",r),...l})});l.displayName="TableHeader";let n=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("tbody",{ref:a,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...l})});n.displayName="TableBody",a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("tfoot",{ref:a,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...l})}).displayName="TableFooter";let i=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("tr",{ref:a,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...l})});i.displayName="TableRow";let o=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("th",{ref:a,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...l})});o.displayName="TableHead";let c=a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("td",{ref:a,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...l})});c.displayName="TableCell",a.forwardRef((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("caption",{ref:a,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...l})}).displayName="TableCaption",e.s(["ChevronLeft",()=>d.default],73375);var d=e.i(12012);e.s(["ChevronRight",()=>u.default],63059);var u=e.i(46349)},17521,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},31278,e=>{"use strict";e.s(["Loader2",()=>t.default]);var t=e.i(17521)},84999,e=>{"use strict";e.s(["default",()=>w],84999);var t=e.i(43476),a=e.i(71645);let s=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var r=e.i(91726),l=e.i(27612),n=e.i(68214),n=n;e.i(47167);var i=e.i(54616),o=e.i(66027),c=e.i(12598);let d="http://localhost:5000/api";async function u(e){if(!e.ok)throw Error((await e.json().catch(()=>({}))).message||"Something went wrong");return e.json()}let m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(0,o.useQuery)({queryKey:["subscribers",t,a],queryFn:async()=>u(await fetch("".concat(d,"/broadcast/subscribe?page=").concat(t,"&limit=").concat(a),{headers:{Authorization:"Bearer ".concat(e)}})),enabled:!!e})};var x=e.i(37727),h=e.i(31278),b=e.i(19455);function g(e){let{accessToken:r,onClose:l}=e,[n,o]=(0,a.useState)(""),[c,m]=(0,a.useState)(""),[g,f]=(0,a.useState)(!1),{mutate:p,isPending:y}=(0,i.useMutation)({mutationFn:async e=>u(await fetch("".concat(d,"/broadcast"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(e)}))});return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-[#181818]",children:"Broadcast to All Subscribers"}),(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,t.jsx)(x.X,{className:"w-5 h-5"})})]}),g?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(s,{className:"w-8 h-8 text-green-600"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Email Sent Successfully!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Your broadcast has been sent to all subscribers."})]}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,t.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email subject"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Content"}),(0,t.jsx)("textarea",{value:c,onChange:e=>m(e.target.value),rows:10,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter email content"})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)(b.Button,{onClick:l,variant:"ghost",className:"border border-gray-300",disabled:y,children:"Cancel"}),(0,t.jsx)(b.Button,{onClick:()=>{if(!n.trim()||!c.trim())return void alert("Please fill in all fields");p({subject:n,html:c},{onSuccess:()=>{f(!0),setTimeout(()=>{l()},2e3)},onError:e=>{alert("Failed to send broadcast: ".concat(e.message))}})},disabled:y,className:"px-6 py-2.5 flex items-center gap-2 disabled:opacity-50 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Loader2,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s,{className:"w-4 h-4"}),"Send Broadcast"]})})]})]})]})})}var n=n;function f(e){let{accessToken:s,subscriber:r,onClose:l}=e,[o,c]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),{mutate:y,isPending:j}=(0,i.useMutation)({mutationFn:async e=>u(await fetch("".concat(d,"/broadcast/specific"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify(e)}))});return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Send Email"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["To: ",r.email]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,t.jsx)(x.X,{className:"w-5 h-5"})})]}),f?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(n.default,{className:"w-8 h-8 text-green-600"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Email Sent Successfully!"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Your email has been sent to ",r.email]})]}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,t.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email subject"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Content"}),(0,t.jsx)("textarea",{value:m,onChange:e=>g(e.target.value),rows:10,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter email content"})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)(b.Button,{onClick:l,variant:"ghost",className:"px-6 py-2.5 border border-gray-300 ",disabled:j,children:"Cancel"}),(0,t.jsx)(b.Button,{onClick:()=>{if(!o.trim()||!m.trim())return void alert("Please fill in all fields");y({email:r.email,subject:o,html:m},{onSuccess:()=>{p(!0),setTimeout(()=>{l()},2e3)},onError:e=>{alert("Failed to send email: ".concat(e.message))}})},disabled:j,className:"px-6 py-2.5 flex items-center gap-2 disabled:opacity-50 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Loader2,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.default,{className:"w-4 h-4"}),"Send Email"]})})]})]})]})})}var p=e.i(17255),y=e.i(24428),j=e.i(73871),N=e.i(46696);function v(e){let{isOpen:a,onClose:s,onConfirm:r,title:l="Delete Subscriber",description:n="Are you sure you want to delete this subscriber? This action cannot be undone.",isLoading:i=!1}=e;return a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/30 backdrop-blur-sm",onClick:s}),(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 ",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:l}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:i,children:(0,t.jsx)(x.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:n})}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 ",children:[(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:"Cancel"}),(0,t.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",disabled:i,children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})})]}):null}function w(){var e,o;let[x,h]=(0,a.useState)(1),[w,S]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),[T,E]=(0,a.useState)(null),[A,B]=(0,a.useState)(!1),[z,F]=(0,a.useState)(null),R=(0,p.useSession)(),D=(null==R||null==(o=R.data)||null==(e=o.user)?void 0:e.accessToken)||"",M=(0,c.useQueryClient)(),{data:P,isLoading:O,isError:K}=m(D,x,10),{mutate:L,isPending:q}=(e=>{let t=(0,c.useQueryClient)();return(0,i.useMutation)({mutationFn:async t=>u(await fetch("".concat(d,"/broadcast/subscribe/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})),onSuccess:()=>{t.invalidateQueries({queryKey:["subscribers"]})}})})(D),H=()=>{B(!1),F(null)},Q=(e=>{let{onSendEmail:a,onOpenDeleteModal:s}=e;return[{accessorKey:"email",header:"Email Address",cell:e=>{let{row:a}=e;return(0,t.jsx)("div",{className:"text-sm text-gray-900",children:a.original.email})}},{accessorKey:"createdAt",header:"Date",cell:e=>{let{row:a}=e,s=new Date(a.original.createdAt);return(0,t.jsx)("div",{className:"text-sm text-gray-600",children:s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}},{id:"actions",header:"Actions",cell:e=>{let{row:r}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>a(r.original),className:"p-2 hover:bg-blue-50 rounded-lg transition-colors group",title:"Send Email",children:(0,t.jsx)(n.default,{className:"w-4 h-4 text-gray-600 group-hover:text-blue-600"})}),(0,t.jsx)("button",{onClick:()=>s(r.original),className:"p-2 hover:bg-red-50 rounded-lg transition-colors group",title:"Delete",children:(0,t.jsx)(l.Trash2,{className:"w-4 h-4 text-gray-600 group-hover:text-red-600"})})]})}}]})({onSendEmail:e=>{E(e),C(!0)},onOpenDeleteModal:e=>{F(e),B(!0)}});return O?(0,t.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,t.jsx)(y.default,{})}):K?(0,t.jsx)(j.default,{title:"Failed to load subscribers",message:"Please try again later or check your network connection.",onRetry:()=>window.location.reload()}):(0,t.jsxs)("div",{className:"py-6",children:[(0,t.jsx)("div",{className:"mb-4 flex justify-end",children:(0,t.jsxs)(b.Button,{onClick:()=>S(!0),className:"px-6 py-2.5 rounded-lg flex items-center gap-2 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:[(0,t.jsx)(s,{className:"w-4 h-4"}),"Broadcast to All Subscribers"]})}),(0,t.jsx)(r.DataTable,{columns:Q,data:(null==P?void 0:P.data.subscribers)||[],pagination:(null==P?void 0:P.data.pagination)?{page:x,pageSize:P.data.pagination.limit,total:P.data.pagination.total,onPageChange:h}:void 0}),(0,t.jsx)(v,{isOpen:A,onClose:H,onConfirm:()=>{z&&L(z._id,{onSuccess:()=>{M.invalidateQueries({queryKey:["subscribers"]}),N.toast.success("Subscriber deleted successfully"),H()},onError:e=>{N.toast.error("Failed to delete subscriber: ".concat(e.message))}})},title:"Delete Subscriber",description:"Are you sure you want to delete ".concat(null==z?void 0:z.email,"? This action cannot be undone."),isLoading:q}),w&&(0,t.jsx)(g,{accessToken:D,onClose:()=>S(!1)}),k&&T&&(0,t.jsx)(f,{accessToken:D,subscriber:T,onClose:()=>{C(!1),E(null)}})]})}}]);