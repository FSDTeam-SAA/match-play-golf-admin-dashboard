module.exports=[37331,a=>{"use strict";a.s(["default",()=>w],37331);var b=a.i(87924),c=a.i(72131);let d=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var e=a.i(23878),f=a.i(81560),g=a.i(45700),g=g,h=a.i(70025),i=a.i(33217),j=a.i(37927);let k="http://localhost:5000/api";async function l(a){if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"Something went wrong");return a.json()}var m=a.i(33508),n=a.i(96221),o=a.i(99570);function p({accessToken:a,onClose:e}){let[f,g]=(0,c.useState)(""),[i,j]=(0,c.useState)(""),[p,q]=(0,c.useState)(!1),{mutate:r,isPending:s}=(0,h.useMutation)({mutationFn:async b=>l(await fetch(`${k}/broadcast`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(b)}))});return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-[#181818]",children:"Broadcast to All Subscribers"}),(0,b.jsx)("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(m.X,{className:"w-5 h-5"})})]}),p?(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(d,{className:"w-8 h-8 text-green-600"})}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Email Sent Successfully!"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Your broadcast has been sent to all subscribers."})]}):(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,b.jsx)("input",{type:"text",value:f,onChange:a=>g(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email subject"})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Content"}),(0,b.jsx)("textarea",{value:i,onChange:a=>j(a.target.value),rows:10,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter email content"})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)(o.Button,{onClick:e,variant:"ghost",className:"border border-gray-300",disabled:s,children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:()=>{if(!f.trim()||!i.trim())return void alert("Please fill in all fields");r({subject:f,html:i},{onSuccess:()=>{q(!0),setTimeout(()=>{e()},2e3)},onError:a=>{alert(`Failed to send broadcast: ${a.message}`)}})},disabled:s,className:"px-6 py-2.5 flex items-center gap-2 disabled:opacity-50 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d,{className:"w-4 h-4"}),"Send Broadcast"]})})]})]})]})})}var g=g;function q({accessToken:a,subscriber:d,onClose:e}){let[f,i]=(0,c.useState)(""),[j,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),{mutate:s,isPending:t}=(0,h.useMutation)({mutationFn:async b=>l(await fetch(`${k}/broadcast/specific`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(b)}))});return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Send Email"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["To: ",d.email]})]}),(0,b.jsx)("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(m.X,{className:"w-5 h-5"})})]}),q?(0,b.jsxs)("div",{className:"p-8 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(g.default,{className:"w-8 h-8 text-green-600"})}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Email Sent Successfully!"}),(0,b.jsxs)("p",{className:"text-gray-600",children:["Your email has been sent to ",d.email]})]}):(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,b.jsx)("input",{type:"text",value:f,onChange:a=>i(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email subject"})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Content"}),(0,b.jsx)("textarea",{value:j,onChange:a=>p(a.target.value),rows:10,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm",placeholder:"Enter email content"})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)(o.Button,{onClick:e,variant:"ghost",className:"px-6 py-2.5 border border-gray-300 ",disabled:t,children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:()=>{if(!f.trim()||!j.trim())return void alert("Please fill in all fields");s({email:d.email,subject:f,html:j},{onSuccess:()=>{r(!0),setTimeout(()=>{e()},2e3)},onError:a=>{alert(`Failed to send email: ${a.message}`)}})},disabled:t,className:"px-6 py-2.5 flex items-center gap-2 disabled:opacity-50 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.default,{className:"w-4 h-4"}),"Send Email"]})})]})]})]})})}var r=a.i(75003),s=a.i(47913),t=a.i(92502),u=a.i(23292);function v({isOpen:a,onClose:c,onConfirm:d,title:e="Delete Subscriber",description:f="Are you sure you want to delete this subscriber? This action cannot be undone.",isLoading:g=!1}){return a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 z-40 bg-black/30 backdrop-blur-sm",onClick:c}),(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 ",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e}),(0,b.jsx)("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:g,children:(0,b.jsx)(m.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("p",{className:"text-sm text-gray-600",children:f})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 ",children:[(0,b.jsx)("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:"Cancel"}),(0,b.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",disabled:g,children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})})]}):null}function w(){let[a,m]=(0,c.useState)(1),[n,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),F=(0,r.useSession)(),G=F?.data?.user?.accessToken||"",H=(0,j.useQueryClient)(),{data:I,isLoading:J,isError:K}=((a,b=1,c=10)=>(0,i.useQuery)({queryKey:["subscribers",b,c],queryFn:async()=>l(await fetch(`${k}/broadcast/subscribe?page=${b}&limit=${c}`,{headers:{Authorization:`Bearer ${a}`}})),enabled:!!a}))(G,a,10),{mutate:L,isPending:M}=(a=>{let b=(0,j.useQueryClient)();return(0,h.useMutation)({mutationFn:async b=>l(await fetch(`${k}/broadcast/subscribe/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})),onSuccess:()=>{b.invalidateQueries({queryKey:["subscribers"]})}})})(G),N=()=>{C(!1),E(null)},O=(({onSendEmail:a,onOpenDeleteModal:c})=>[{accessorKey:"email",header:"Email Address",cell:({row:a})=>(0,b.jsx)("div",{className:"text-sm text-gray-900",children:a.original.email})},{accessorKey:"createdAt",header:"Date",cell:({row:a})=>{let c=new Date(a.original.createdAt);return(0,b.jsx)("div",{className:"text-sm text-gray-600",children:c.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})}},{id:"actions",header:"Actions",cell:({row:d})=>(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>a(d.original),className:"p-2 hover:bg-blue-50 rounded-lg transition-colors group",title:"Send Email",children:(0,b.jsx)(g.default,{className:"w-4 h-4 text-gray-600 group-hover:text-blue-600"})}),(0,b.jsx)("button",{onClick:()=>c(d.original),className:"p-2 hover:bg-red-50 rounded-lg transition-colors group",title:"Delete",children:(0,b.jsx)(f.Trash2,{className:"w-4 h-4 text-gray-600 group-hover:text-red-600"})})]})}])({onSendEmail:a=>{A(a),y(!0)},onOpenDeleteModal:a=>{E(a),C(!0)}});return J?(0,b.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,b.jsx)(s.default,{})}):K?(0,b.jsx)(t.default,{title:"Failed to load subscribers",message:"Please try again later or check your network connection.",onRetry:()=>window.location.reload()}):(0,b.jsxs)("div",{className:"py-6",children:[(0,b.jsx)("div",{className:"mb-4 flex justify-end",children:(0,b.jsxs)(o.Button,{onClick:()=>w(!0),className:"px-6 py-2.5 rounded-lg flex items-center gap-2 transition-colors bg-red-600 hover:bg-red-600/60 cursor-pointer",children:[(0,b.jsx)(d,{className:"w-4 h-4"}),"Broadcast to All Subscribers"]})}),(0,b.jsx)(e.DataTable,{columns:O,data:I?.data.subscribers||[],pagination:I?.data.pagination?{page:a,pageSize:I.data.pagination.limit,total:I.data.pagination.total,onPageChange:m}:void 0}),(0,b.jsx)(v,{isOpen:B,onClose:N,onConfirm:()=>{D&&L(D._id,{onSuccess:()=>{H.invalidateQueries({queryKey:["subscribers"]}),u.toast.success("Subscriber deleted successfully"),N()},onError:a=>{u.toast.error(`Failed to delete subscriber: ${a.message}`)}})},title:"Delete Subscriber",description:`Are you sure you want to delete ${D?.email}? This action cannot be undone.`,isLoading:M}),n&&(0,b.jsx)(p,{accessToken:G,onClose:()=>w(!1)}),x&&z&&(0,b.jsx)(q,{accessToken:G,subscriber:z,onClose:()=>{y(!1),A(null)}})]})}}];

//# sourceMappingURL=0f3f9_subscriber-management__components__components_subscriber-management_tsx_410c950a._.js.map