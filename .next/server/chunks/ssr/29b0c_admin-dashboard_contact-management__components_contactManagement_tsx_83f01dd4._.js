module.exports=[4825,a=>{"use strict";a.s(["default",()=>w],4825);var b=a.i(21535),c=a.i(7765),d=a.i(87175),e=a.i(79512),f=a.i(14324),g=a.i(19684),h=a.i(97905),i=a.i(60919);let j="http://localhost:5000/api/v1";async function k(a){if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"Something went wrong");return a.json()}var l=a.i(19506),m=a.i(14133),n=a.i(58201),o=a.i(17033),p=a.i(93264);function q({contacts:a,onView:e,onRespond:f,onDelete:g,isLoading:h,currentPage:i,totalPages:j,totalData:k,hasNextPage:q,hasPrevPage:r,onPageChange:s}){let[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1);return h?(0,b.jsx)(p.default,{}):a||h?(0,b.jsxs)("div",{className:"bg-white rounded-lg border",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"max-w-xs",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:a.fullName}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:a.occupation})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("div",{className:"max-w-md",children:(0,b.jsx)("span",{className:"text-sm text-gray-600 line-clamp-2",children:a.message||"-"})})}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600 whitespace-nowrap",children:a.email}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:a.createdAt?new Date(a.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("span",{className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${"New"===a.status?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:a.status})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>e(a),className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded",title:"View",children:(0,b.jsx)(n.Eye,{className:"w-5 h-5 cursor-pointer"})}),(0,b.jsx)("button",{onClick:()=>f(a),className:`transition-colors p-1 rounded ${"New"===a.status?"text-green-600 hover:text-green-800":"text-gray-400 cursor-not-allowed"}`,title:"New"===a.status?"Respond":"Already Responded",disabled:"Respond"===a.status,children:(0,b.jsx)(o.MessageSquare,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>{u(a),w(!0)},className:"text-red-600 hover:text-red-800 transition-colors p-1 rounded",title:"Delete",children:(0,b.jsx)(m.Trash2,{className:"w-5 h-5 cursor-pointer"})})]})})]},a._id))})]})}),(0,b.jsx)(l.Dialog,{open:v,onOpenChange:w,children:(0,b.jsxs)(l.DialogContent,{children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Confirm Deletion"}),(0,b.jsxs)(l.DialogDescription,{children:['Are you sure you want to delete the contact from "',t?.fullName,'"? This action cannot be undone.']})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(l.DialogClose,{asChild:!0,children:(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{w(!1),u(null)},children:"Cancel"})}),(0,b.jsx)(d.Button,{variant:"destructive",onClick:()=>{t&&(g(t._id),u(null),w(!1))},children:"Confirm Delete"})]})]})}),j>0&&(0,b.jsxs)("div",{className:"bg-white px-6 py-4 flex items-center justify-between border-t border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,b.jsxs)("span",{children:["Showing page ",i," of ",j]}),(0,b.jsx)("span",{className:"text-gray-400",children:"â€¢"}),(0,b.jsxs)("span",{children:[k," total contacts"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{onClick:()=>s(i-1),disabled:!r,className:`px-3 py-2 rounded border text-sm font-medium ${r?"text-gray-700 border-gray-300 hover:bg-gray-50":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:"Previous"}),(function(){let a=[];if(j<=5)for(let b=1;b<=j;b++)a.push(b);else if(i<=3){for(let b=1;b<=3;b++)a.push(b);a.push("..."),a.push(j)}else if(i>=j-2){a.push(1),a.push("...");for(let b=j-2;b<=j;b++)a.push(b)}else a.push(1),a.push("..."),a.push(i-1),a.push(i),a.push(i+1),a.push("..."),a.push(j);return a})().map((a,c)=>(0,b.jsx)("button",{onClick:()=>"number"==typeof a&&s(a),disabled:"..."===a,className:`px-3 py-2 rounded border text-sm font-medium min-w-[40px] ${a===i?"bg-blue-600 text-white border-blue-600":"..."===a?"text-gray-400 border-gray-200 cursor-default":"text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:a},c)),(0,b.jsx)("button",{onClick:()=>s(i+1),disabled:!q,className:`px-3 py-2 rounded border text-sm font-medium ${q?"text-gray-700 border-gray-300 hover:bg-gray-50":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:"Next"})]})]})]}):(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-lg",children:"No contacts found"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:"New contacts will appear here"})]})}var r=a.i(28134),s=a.i(42589),t=a.i(18766),u=a.i(29635);function v({contact:a,isOpen:e,onClose:f,onSuccess:h,accessToken:m}){let[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),{mutate:r,isPending:v}=((a,b)=>{let c=(0,i.useQueryClient)();return(0,g.useMutation)({mutationFn:async({contactId:b,responseMessage:c})=>k(await fetch(`${j}/contracts/${b}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({responseMessage:c})})),onSuccess:()=>{c.invalidateQueries({queryKey:["contacts"]}),c.invalidateQueries({queryKey:["contact"]}),b?.onSuccess?.()},onError:a=>{b?.onError?.(a)}})})(m,{onSuccess:()=>{o(""),q(""),h()},onError:a=>{q(a.message||"Failed to send response")}}),w=()=>{v||(o(""),q(""),f())};return(0,b.jsx)(l.Dialog,{open:e,onOpenChange:w,children:(0,b.jsxs)(l.DialogContent,{className:"sm:max-w-[600px]",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Respond to Contact"}),(0,b.jsxs)(l.DialogDescription,{children:["Send a response to ",a?.fullName]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Name:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:a?.fullName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Email:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:a?.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Phone:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:a?.phoneNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Occupation:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:a?.occupation})]})]}),(0,b.jsxs)("div",{className:"pt-2 border-t",children:[(0,b.jsx)("span",{className:"text-gray-500 text-sm",children:"Message:"}),(0,b.jsx)("p",{className:"text-sm mt-1 text-gray-700",children:a?.message})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"responseMessage",className:"text-sm font-medium",children:"Your Response *"}),(0,b.jsx)(s.Textarea,{id:"responseMessage",placeholder:"Enter your response message...",value:n,onChange:a=>{o(a.target.value),q("")},className:"mt-2 min-h-[120px]",disabled:v}),p&&(0,b.jsx)("p",{className:"text-red-500 text-sm mt-2",children:p})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:w,disabled:v,children:"Cancel"}),(0,b.jsx)(d.Button,{onClick:()=>n.trim()?a?._id?void r({contactId:a._id,responseMessage:n.trim()}):void q("Invalid contact"):void q("Please enter a response message"),disabled:v,children:v?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):"Send Response"})]})]})})}function w(){let[a,m]=(0,c.useState)(1),[n,o]=(0,c.useState)(!1),[p,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),y=(0,r.useSession)(),z=y.data?.user?.accessToken||"",{data:A,isLoading:B,error:C,refetch:D}=((a,b=1,c=10)=>(0,h.useQuery)({queryKey:["contacts",b,c,a],queryFn:async()=>k(await fetch(`${j}/contracts?page=${b}&limit=5`,{credentials:"include",headers:{Authorization:`Bearer ${a}`}})),enabled:!!a}))(z,a,10),{mutate:E,isPending:F}=(a=>{let b=(0,i.useQueryClient)();return(0,g.useMutation)({mutationFn:async b=>k(await fetch(`${j}/contracts/${b}`,{method:"DELETE",credentials:"include",headers:{Authorization:`Bearer ${a}`}})),onSuccess:()=>{b.invalidateQueries({queryKey:["contacts"]})}})})(z);(0,c.useEffect)(()=>{z&&D()},[z,a]);let G=A?.data?.contracts||[],H=A?.data?.pagination;return C?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:(0,b.jsx)(e.Card,{className:"w-full max-w-md",children:(0,b.jsxs)(e.CardContent,{className:"pt-6 text-center",children:[(0,b.jsx)("div",{className:"text-red-500 text-lg font-semibold mb-2",children:"Error Loading Contacts"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Failed to load contacts. Please try again."}),(0,b.jsx)(d.Button,{onClick:()=>D(),children:"Retry"})]})})}):(0,b.jsx)("div",{className:"bg-gray-50",children:(0,b.jsxs)("div",{className:"w-full mx-auto",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-[#5A8DEE]",children:"Contact Management"}),(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mt-2",children:[(0,b.jsx)("span",{children:"Dashboard"}),(0,b.jsx)(f.ChevronRight,{className:"w-4 h-4 mx-2"}),(0,b.jsx)("span",{className:"text-gray-900 font-medium",children:"Contact Management"})]})]})})}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"All Contacts"})}),(0,b.jsx)(e.CardContent,{className:"p-0",children:(0,b.jsx)(q,{contacts:G,onView:a=>{u(a),o(!0)},onRespond:a=>{x(a),s(!0)},onDelete:a=>{E(a,{onSuccess:()=>{D()}})},isLoading:B||F,currentPage:a,totalPages:H?.totalPages||1,totalData:H?.totalData||0,hasNextPage:H?.hasNextPage||!1,hasPrevPage:H?.hasPrevPage||!1,onPageChange:a=>{m(a),window.scrollTo({top:0,behavior:"smooth"})}})})]}),(0,b.jsx)(l.Dialog,{open:n,onOpenChange:o,children:(0,b.jsxs)(l.DialogContent,{className:"!max-w-3xl w-full max-h-[90vh] overflow-y-auto rounded-xl shadow-lg",children:[(0,b.jsx)(l.DialogHeader,{className:"sticky top-0 bg-white border-b pb-4",children:(0,b.jsx)(l.DialogTitle,{className:"text-2xl font-semibold text-gray-900",children:"Contact Details"})}),t&&(0,b.jsxs)("div",{className:"space-y-6 py-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:t.fullName}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-4",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:["ðŸ“§ ",t.email]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:["ðŸ“ž ",t.phoneNumber]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:["ðŸ’¼ ",t.occupation]})]}),(0,b.jsx)("div",{className:"inline-block",children:(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${"New"===t.status?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:t.status})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-lg mb-3 text-gray-900",children:"Message"}),(0,b.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:t.message})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Received At"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Last Updated"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:new Date(t.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})]})}),(0,b.jsx)(v,{contact:w,isOpen:p,onClose:()=>{s(!1),x(null)},onSuccess:()=>{D(),s(!1),x(null)},accessToken:z})]})})}}];

//# sourceMappingURL=29b0c_admin-dashboard_contact-management__components_contactManagement_tsx_83f01dd4._.js.map